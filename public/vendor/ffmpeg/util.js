!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.FFmpegUtil=t():e.FFmpegUtil=t()}(self,()=>(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);var t=function(e,t,r,o){return new(r||(r=Promise))(function(n,i){function d(e){try{a(o.next(e))}catch(e){i(e)}}function l(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(d,l)}a((o=o.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.toBlobURL=exports.downloadWithProgress=exports.importScript=exports.fetchFile=void 0;let r=require("./errors.js"),o=require("./const.js");return exports.fetchFile=e=>t(void 0,void 0,void 0,function*(){let t;if("string"==typeof e)t=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0)):yield(yield fetch(e)).arrayBuffer();else if(e instanceof URL)t=yield(yield fetch(e)).arrayBuffer();else{if(!(e instanceof File||e instanceof Blob))return new Uint8Array;t=yield new Promise((t,r)=>{let o=new FileReader;o.onload=()=>{let{result:e}=o;e instanceof ArrayBuffer?t(new Uint8Array(e)):t(new Uint8Array)},o.onerror=e=>{var t,o;r(Error(`File could not be read! Code=${(null===(o=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.error)||void 0===o?void 0:o.code)||-1}`))},o.readAsArrayBuffer(e)})}return new Uint8Array(t)}),exports.importScript=e=>t(void 0,void 0,void 0,function*(){return new Promise(t=>{let r=document.createElement("script"),o=()=>{r.removeEventListener("load",o),t()};r.src=e,r.type="text/javascript",r.addEventListener("load",o),document.getElementsByTagName("head")[0].appendChild(r)})}),exports.downloadWithProgress=(e,n)=>t(void 0,void 0,void 0,function*(){var t;let i;let d=yield fetch(e);try{let l=parseInt(d.headers.get(o.HeaderContentLength)||"-1"),a=null===(t=d.body)||void 0===t?void 0:t.getReader();if(!a)throw r.ERROR_RESPONSE_BODY_READER;let f=[],s=0;for(;;){let{done:t,value:o}=yield a.read(),i=o?o.length:0;if(t){if(-1!=l&&l!==s)throw r.ERROR_INCOMPLETED_DOWNLOAD;n&&n({url:e,total:l,received:s,delta:i,done:t});break}f.push(o),s+=i,n&&n({url:e,total:l,received:s,delta:i,done:t})}let c=new Uint8Array(s),u=0;for(let e of f)c.set(e,u),u+=e.length;i=c.buffer}catch(t){console.log("failed to send download progress event: ",t),i=yield d.arrayBuffer(),n&&n({url:e,total:i.byteLength,received:i.byteLength,delta:0,done:!0})}return i}),exports.toBlobURL=(e,r,o=!1,n)=>t(void 0,void 0,void 0,function*(){let t=new Blob([o?yield(0,exports.downloadWithProgress)(e,n):yield(yield fetch(e)).arrayBuffer()],{type:r});return URL.createObjectURL(t)}),e})());