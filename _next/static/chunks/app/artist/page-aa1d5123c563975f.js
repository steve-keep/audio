(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[366],{803:function(){},64:function(e,t,r){Promise.resolve().then(r.bind(r,9321))},9321:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var n=r(7437),a=r(2265),i=r(7138),s=r(2561),l=r(6517);function c(e){let{artistName:t,artistImageUrl:r}=e,[i,s]=(0,a.useState)(!1),l=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=()=>{if(l.current){let{top:e}=l.current.getBoundingClientRect();s(e<=0)}};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{ref:l,className:"artist-header",children:[(0,n.jsx)("img",{src:r,alt:t,className:"artist-header-image"}),(0,n.jsx)("h1",{className:"artist-header-name",children:t})]}),(0,n.jsx)("div",{className:"sticky-header ".concat(i?"visible":""),children:(0,n.jsx)("h2",{children:t})})]})}function u(e){let{allAlbums:t,libraryAlbums:r}=e,[i,s]=(0,a.useState)("all");return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"album-tabs",children:[(0,n.jsx)("button",{onClick:()=>s("all"),className:"all"===i?"active":"",children:"All Albums"}),(0,n.jsx)("button",{onClick:()=>s("library"),className:"library"===i?"active":"",children:"In Library"})]}),(0,n.jsx)("div",{children:"all"===i?t:r})]})}var o=r(3624);function m(e){let{albums:t,showLibraryIcon:r}=e;return(0,n.jsx)("div",{className:"grid-container",children:t.map(e=>(0,n.jsxs)(i.default,{href:"/album#".concat(encodeURIComponent(e.artistName),"/").concat(encodeURIComponent(e.name)),className:"grid-item",children:[e.imageUrl&&(0,n.jsx)("img",{src:e.imageUrl,alt:e.name}),(0,n.jsxs)("h3",{children:[e.name,r&&r(e.name)&&(0,n.jsx)(o.Z,{})]})]},e.name))})}function d(){let[e,t]=(0,a.useState)(null),[r,o]=(0,a.useState)([]),[d,f]=(0,a.useState)([]),[E,h]=(0,a.useState)("");return((0,a.useEffect)(()=>{let e=()=>{h(decodeURIComponent(window.location.hash.substring(1)))};return e(),window.addEventListener("hashchange",e),()=>{window.removeEventListener("hashchange",e)}},[]),(0,a.useEffect)(()=>{E&&(async()=>{await (0,s.zK)();let e=(0,s.aU)(E);if(!e||!e.imageUrl)try{var r,n;let t=await fetch("https://www.theaudiodb.com/api/v1/json/".concat(l.$,"/search.php?s=").concat(E)),a=await t.json(),i=(null===(n=a.artists)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.strArtistThumb)||"/placeholder.svg";e={name:E,imageUrl:i},(0,s.EP)(e)}catch(t){console.error("Error fetching artist image:",t),e={name:E,imageUrl:"/placeholder.svg"}}t(e);let a=(0,s.bN)(E);o(await Promise.all(a.map(async e=>{let t=(0,s.eK)(e,E);if(t&&t.imageUrl)return t;try{var r,n;let a=await fetch("https://www.theaudiodb.com/api/v1/json/".concat(l.$,"/searchalbum.php?s=").concat(E,"&a=").concat(e)),i=await a.json(),c=(null===(n=i.album)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.strAlbumThumb)||"/placeholder.svg";return t={name:e,artistName:E,imageUrl:c},(0,s.ZG)(t),t}catch(t){return console.error("Error fetching album image:",t),{name:e,artistName:E,imageUrl:"/placeholder.svg"}}})));let i=localStorage.getItem("artist-albums-".concat(E));if(i){let{timestamp:e,data:t}=JSON.parse(i);if(Date.now()-e<864e5){f(t);return}}try{let e=await fetch("https://www.theaudiodb.com/api/v1/json/".concat(l.$,"/searchalbum.php?s=").concat(E)),t=(await e.json()).album.map(e=>({name:e.strAlbum,artistName:E,imageUrl:e.strAlbumThumb||"/placeholder.svg"}));f(t),localStorage.setItem("artist-albums-".concat(E),JSON.stringify({timestamp:Date.now(),data:t}))}catch(e){console.error("Error fetching all albums:",e)}})()},[E]),e)?(0,n.jsxs)("main",{children:[(0,n.jsx)(i.default,{href:"/artists",style:{marginBottom:"1.5rem",display:"inline-block"},children:"← Back to Artists"}),(0,n.jsx)(c,{artistName:e.name,artistImageUrl:e.imageUrl}),(0,n.jsx)(u,{allAlbums:(0,n.jsx)(m,{albums:d,showLibraryIcon:e=>r.some(t=>t.name===e)}),libraryAlbums:(0,n.jsx)(m,{albums:r})})]}):(0,n.jsxs)("main",{children:[(0,n.jsx)(i.default,{href:"/artists",style:{marginBottom:"1.5rem",display:"inline-block"},children:"← Back to Artists"}),(0,n.jsx)("h1",{children:"Loading..."})]})}},3624:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(7437);function a(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",marginLeft:"8px"},children:[(0,n.jsx)("path",{d:"M2 6s1.5-2 5-2 5 2 5 2v14s-1.5-1-5-1-5 1-5 1V6z"}),(0,n.jsx)("path",{d:"M12 6s1.5-2 5-2 5 2 5 2v14s-1.5-1-5-1-5 1-5 1V6z"})]})}},6517:function(e,t,r){"use strict";r.d(t,{$:function(){return n}});let n="123"},2561:function(e,t,r){"use strict";r.d(t,{EP:function(){return h},Jl:function(){return v},Lj:function(){return x},UM:function(){return d},Xs:function(){return j},ZG:function(){return b},Zi:function(){return I},aU:function(){return g},bN:function(){return N},eK:function(){return T},fC:function(){return p},gG:function(){return E},k8:function(){return R},mF:function(){return w},zK:function(){return f}});var n=r(2040),a=r.n(n);let i=null,s=null,l="audio-indexer-db",c="database";async function u(){return s||(s=await a()({locateFile:e=>"https://sql.js.org/dist/".concat(e)}))}function o(){return new Promise((e,t)=>{let r=indexedDB.open(l,1);r.onerror=()=>t("Error opening IndexedDB"),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{e.target.result.createObjectStore(c)}})}async function m(){let e=await o();return new Promise((t,r)=>{let n=e.transaction(c,"readonly").objectStore(c).get("db");n.onerror=()=>r("Error loading from IndexedDB"),n.onsuccess=()=>t(n.result)})}async function d(){if(!i)return;let e=i.export();(await o()).transaction(c,"readwrite").objectStore(c).put(e,"db")}async function f(){if(i)return i;let e=await u(),t=await m();return(i=t?new e.Database(t):new e.Database)&&i.run("\n    CREATE TABLE IF NOT EXISTS tracks (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      title TEXT,\n      artist TEXT,\n      album TEXT,\n      track TEXT\n    );\n    CREATE TABLE IF NOT EXISTS artists (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      name TEXT UNIQUE,\n      imageUrl TEXT\n    );\n    CREATE TABLE IF NOT EXISTS albums (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      name TEXT,\n      artistName TEXT,\n      imageUrl TEXT,\n      UNIQUE(name, artistName)\n    );\n  "),i}function E(e){if(!i)return;let t=i.prepare("INSERT INTO tracks (title, artist, album, track) VALUES (?, ?, ?, ?)");t.run([e.title,e.artist,e.album,e.track]),t.free()}function h(e){if(!i)return;let t=i.prepare("INSERT OR IGNORE INTO artists (name, imageUrl) VALUES (?, ?)");t.run([e.name,e.imageUrl]),t.free()}function b(e){if(!i)return;let t=i.prepare("INSERT OR IGNORE INTO albums (name, artistName, imageUrl) VALUES (?, ?, ?)");t.run([e.name,e.artistName,e.imageUrl]),t.free()}function p(){if(!i)return[];let e=i.exec("SELECT DISTINCT artist FROM tracks ORDER BY artist");return 0===e.length?[]:e[0].values.map(e=>null==e?void 0:e[0])}function g(e){if(!i)return null;let t=i.prepare("SELECT name, imageUrl FROM artists WHERE name = ?");if(t.bind([e]),t.step()){let e=t.getAsObject();return t.free(),e}return t.free(),null}function T(e,t){if(!i)return null;let r=i.prepare("SELECT name, artistName, imageUrl FROM albums WHERE name = ? AND artistName = ?");if(r.bind([e,t]),r.step()){let e=r.getAsObject();return r.free(),e}return r.free(),null}function N(e){if(!i)return[];let t=i.prepare("SELECT DISTINCT album FROM tracks WHERE artist = ? ORDER BY album");t.bind([e]);let r=[];for(;t.step();)r.push(t.get()[0]);return t.free(),r}function w(e,t){if(!i)return[];let r=i.prepare("SELECT title, artist, album, track FROM tracks WHERE album = ? AND artist = ? ORDER BY CAST(track AS INTEGER)");r.bind([e,t]);let n=[];for(;r.step();)n.push(r.getAsObject());return r.free(),n}function R(){if(!i)return[];let e=i.prepare("SELECT name, artistName, imageUrl FROM albums ORDER BY name"),t=[];for(;e.step();)t.push(e.getAsObject());return e.free(),t}function v(){if(!i)return[];let e=i.prepare("SELECT title, artist, album, track FROM tracks ORDER BY artist, album, CAST(track AS INTEGER)"),t=[];for(;e.step();)t.push(e.getAsObject());return e.free(),t}function j(){return i?i.export():null}async function I(e){let t=await u();i&&i.close(),i=new t.Database(e),await d()}async function x(){return i&&(i.close(),i=null),new Promise((e,t)=>{let r=indexedDB.deleteDatabase(l);r.onerror=()=>t("Error deleting database"),r.onsuccess=()=>e()})}},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var n=r(231),a=r.n(n)}},function(e){e.O(0,[218,231,251,128,971,23,744],function(){return e(e.s=64)}),_N_E=e.O()}]);