(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[103],{803:function(){},1914:function(e,t,r){Promise.resolve().then(r.bind(r,8560))},2561:function(e,t,r){"use strict";r.d(t,{EP:function(){return T},Jl:function(){return g},Lj:function(){return S},QT:function(){return w},UM:function(){return d},Xs:function(){return O},ZG:function(){return h},Zi:function(){return I},_T:function(){return v},aU:function(){return p},bN:function(){return N},eK:function(){return b},fC:function(){return x},gG:function(){return m},k8:function(){return R},mF:function(){return j},qn:function(){return k},zK:function(){return E}});var n=r(2040),a=r.n(n);let s=null,i=null,l="audio-indexer-db",u="database";async function c(){return i||(i=await a()({locateFile:e=>"https://sql.js.org/dist/".concat(e)}))}function o(){return new Promise((e,t)=>{let r=indexedDB.open(l,1);r.onerror=()=>t("Error opening IndexedDB"),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{e.target.result.createObjectStore(u)}})}async function f(){let e=await o();return new Promise((t,r)=>{let n=e.transaction(u,"readonly").objectStore(u).get("db");n.onerror=()=>r("Error loading from IndexedDB"),n.onsuccess=()=>t(n.result)})}async function d(){if(!s)return;let e=s.export();(await o()).transaction(u,"readwrite").objectStore(u).put(e,"db")}async function E(){if(s)return s;let e=await c(),t=await f();return(s=t?new e.Database(t):new e.Database)&&s.run("\n    CREATE TABLE IF NOT EXISTS tracks (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      title TEXT,\n      artist TEXT,\n      album TEXT,\n      track TEXT\n    );\n    CREATE TABLE IF NOT EXISTS artists (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      name TEXT UNIQUE,\n      imageUrl TEXT\n    );\n    CREATE TABLE IF NOT EXISTS albums (\n      id INTEGER PRIMARY KEY AUTOINCREMENT,\n      name TEXT,\n      artistName TEXT,\n      imageUrl TEXT,\n      UNIQUE(name, artistName)\n    );\n  "),s}function m(e){if(!s)return;let t=s.prepare("INSERT INTO tracks (title, artist, album, track) VALUES (?, ?, ?, ?)");t.run([e.title,e.artist,e.album,e.track]),t.free()}function T(e){if(!s)return;let t=s.prepare("INSERT OR IGNORE INTO artists (name, imageUrl) VALUES (?, ?)");t.run([e.name,e.imageUrl]),t.free()}function h(e){if(!s)return;let t=s.prepare("INSERT OR IGNORE INTO albums (name, artistName, imageUrl) VALUES (?, ?, ?)");t.run([e.name,e.artistName,e.imageUrl]),t.free()}function x(){if(!s)return[];let e=s.exec("SELECT DISTINCT artist FROM tracks ORDER BY artist");return 0===e.length?[]:e[0].values.map(e=>null==e?void 0:e[0])}function p(e){if(!s)return null;let t=s.prepare("SELECT name, imageUrl FROM artists WHERE name = ?");if(t.bind([e]),t.step()){let e=t.getAsObject();return t.free(),e}return t.free(),null}function b(e,t){if(!s)return null;let r=s.prepare("SELECT name, artistName, imageUrl FROM albums WHERE name = ? AND artistName = ?");if(r.bind([e,t]),r.step()){let e=r.getAsObject();return r.free(),e}return r.free(),null}function N(e){if(!s)return[];let t=s.prepare("SELECT DISTINCT album FROM tracks WHERE artist = ? ORDER BY album");t.bind([e]);let r=[];for(;t.step();)r.push(t.get()[0]);return t.free(),r}function j(e,t){if(!s)return[];let r=s.prepare("SELECT title, artist, album, track FROM tracks WHERE album = ? AND artist = ? ORDER BY CAST(track AS INTEGER)");r.bind([e,t]);let n=[];for(;r.step();)n.push(r.getAsObject());return r.free(),n}function R(){if(!s)return[];let e=s.prepare("SELECT name, artistName, imageUrl FROM albums ORDER BY name"),t=[];for(;e.step();)t.push(e.getAsObject());return e.free(),t}function g(){if(!s)return[];let e=s.prepare("SELECT title, artist, album, track FROM tracks ORDER BY artist, album, CAST(track AS INTEGER)"),t=[];for(;e.step();)t.push(e.getAsObject());return e.free(),t}function k(){if(!s)return 0;let e=s.exec("SELECT COUNT(*) FROM artists");return 0!==e.length&&e[0].values[0]?e[0].values[0][0]:0}function w(){if(!s)return 0;let e=s.exec("SELECT COUNT(*) FROM albums");return 0!==e.length&&e[0].values[0]?e[0].values[0][0]:0}function v(){if(!s)return 0;let e=s.exec("SELECT COUNT(*) FROM tracks");return 0!==e.length&&e[0].values[0]?e[0].values[0][0]:0}function O(){return s?s.export():null}async function I(e){let t=await c();s&&s.close(),s=new t.Database(e),await d()}async function S(){return s&&(s.close(),s=null),new Promise((e,t)=>{let r=indexedDB.deleteDatabase(l);r.onerror=()=>t("Error deleting database"),r.onsuccess=()=>e()})}},8560:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(7437),a=r(2265),s=r(7138);function i(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M9 18V5l12-2v13"}),(0,n.jsx)("circle",{cx:"6",cy:"18",r:"3"}),(0,n.jsx)("circle",{cx:"18",cy:"16",r:"3"})]})}var l=r(2561);function u(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}function c(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),(0,n.jsx)("circle",{cx:"12",cy:"7",r:"4"})]})}function o(){return(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}function f(){let[e,t]=(0,a.useState)(null),[r,f]=(0,a.useState)(!0);(0,a.useEffect)(()=>{!async function(){await (0,l.zK)(),t({artists:(0,l.qn)(),albums:(0,l.QT)(),tracks:(0,l._T)()}),f(!1)}()},[]);let d=[{href:"/artists",icon:(0,n.jsx)(c,{}),label:"Artists",count:null==e?void 0:e.artists},{href:"/albums",icon:(0,n.jsx)(o,{}),label:"Albums",count:null==e?void 0:e.albums},{href:"/tracks",icon:(0,n.jsx)(i,{}),label:"Tracks",count:null==e?void 0:e.tracks}];return r?(0,n.jsxs)("main",{children:[(0,n.jsxs)("div",{className:"header",children:[(0,n.jsx)("h1",{children:"My Library"}),(0,n.jsx)(s.default,{href:"/settings","data-testid":"settings-link",children:(0,n.jsx)(u,{})})]}),(0,n.jsx)("div",{className:"library-list",children:[void 0,void 0,void 0].map((e,t)=>(0,n.jsx)("div",{className:"library-list-item",children:(0,n.jsxs)("a",{children:[(0,n.jsx)("div",{className:"skeleton-icon"}),(0,n.jsx)("div",{className:"skeleton-text"}),(0,n.jsx)("div",{className:"skeleton-text-small"})]})},t))})]}):(0,n.jsxs)("main",{children:[(0,n.jsxs)("div",{className:"header",children:[(0,n.jsx)("h1",{children:"My Library"}),(0,n.jsx)(s.default,{href:"/settings","data-testid":"settings-link",children:(0,n.jsx)(u,{})})]}),(0,n.jsx)("ul",{className:"library-list",children:d.map(e=>{let{href:t,icon:r,label:a,count:i}=e;return(0,n.jsx)("li",{className:"library-list-item",children:(0,n.jsxs)(s.default,{href:t,children:[r,(0,n.jsx)("span",{className:"label",children:a}),(0,n.jsxs)("span",{className:"count",children:[i," ",1===i?a.slice(0,-1).toLowerCase():a.toLowerCase()]})]})},t)})})]})}}},function(e){e.O(0,[218,251,128,138,971,23,744],function(){return e(e.s=1914)}),_N_E=e.O()}]);