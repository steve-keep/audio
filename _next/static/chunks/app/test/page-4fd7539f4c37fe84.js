(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[928],{7401:function(e,t,a){Promise.resolve().then(a.bind(a,914))},914:function(e,t,a){"use strict";a.r(t);var s=a(7437),r=a(2265),i=a(2638),n=a.n(i),l=a(6647),o=a.n(l),c=a(3070);let d=[".mp3",".flac",".m4a"];t.default=()=>{let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(!1),[l,m]=(0,r.useState)(null),[u,h]=(0,r.useState)(""),[w,g]=(0,r.useState)(!1),[f,b]=(0,r.useState)("jsmediatags");(0,r.useEffect)(()=>{if(window.taglibWasm){g(!0);return}let e=document.createElement("script");return e.src="/audio/vendor/taglib-wasm/lib-via-script-tag.js",e.async=!0,e.onload=()=>g(!0),e.onerror=()=>console.error("Failed to load the taglib-wasm script."),document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]);let j=async()=>{try{let e=await window.showDirectoryPicker();m(e),t([]),h("Selected directory: ".concat(e.name))}catch(e){e instanceof DOMException&&"AbortError"===e.name?console.log("Directory selection was canceled."):console.error("Error selecting directory:",e)}},x=async e=>{let t=[],a=async e=>{for await(let s of e.values())"file"===s.kind?d.some(e=>s.name.toLowerCase().endsWith(e))&&t.push(s):"directory"===s.kind&&await a(s)};return await a(e),t},p=async(e,a)=>{t([]),h("Testing ".concat(a,"..."));let s=performance.now(),r=0;try{if("jsmediatags"===a)for(let t of e){let e=await t.getFile();await new Promise((t,a)=>{o().read(e,{onSuccess:()=>t(),onError:e=>a(e)})}),r++}else if("music-metadata-browser"===a)for(let t of e){let e=await t.getFile();await c.Aj(e),r++}else if("taglib-wasm"===a){if(w&&window.taglibWasm){let t=await window.taglibWasm.TagLib.initialize({locateFile:e=>e.endsWith(".wasm")?"/audio/vendor/taglib-wasm/taglib.wasm":e});for(let a of e)try{let e=await a.getFile(),s=await e.arrayBuffer(),i=new Uint8Array(s),n=await t.open(i,e.name);n.tag(),n.delete(),r++}catch(e){console.error("taglib-wasm failed to process ".concat(a.name,":"),e)}}else throw Error("taglib-wasm is not loaded.")}}catch(e){h("Error during testing ".concat(a,": ").concat(e instanceof Error?e.message:String(e))),console.error(e),t([{library:a,filesProcessed:r,timeTaken:performance.now()-s}]);return}t([{library:a,filesProcessed:r,timeTaken:performance.now()-s}])},y=async()=>{if(!l)return;i(!0),h("Scanning directory for audio files...");let e=await x(l);h("Found ".concat(e.length," audio files. Now running test...")),await p(e,f),i(!1),h("Testing complete. Processed ".concat(e.length," files with ").concat(f,"."))};return(0,s.jsxs)("div",{className:n().container,children:[(0,s.jsx)("h1",{children:"Metadata Speed Test"}),(0,s.jsxs)("div",{className:n().form,children:[(0,s.jsx)("button",{onClick:j,disabled:a,children:l?"Selected: ".concat(l.name):"Select Directory"}),(0,s.jsxs)("select",{value:f,onChange:e=>b(e.target.value),children:[(0,s.jsx)("option",{value:"jsmediatags",children:"jsmediatags"}),(0,s.jsx)("option",{value:"music-metadata-browser",children:"music-metadata-browser"}),(0,s.jsx)("option",{value:"taglib-wasm",children:"taglib-wasm"})]}),(0,s.jsx)("button",{onClick:y,disabled:!l||a||"taglib-wasm"===f&&!w,children:a?"Scanning...":"Run Test"})]}),!w&&(0,s.jsx)("p",{children:"Loading metadata library..."}),u&&(0,s.jsx)("p",{children:u}),e.length>0&&(0,s.jsxs)("div",{className:n().results,children:[(0,s.jsx)("h2",{children:"Results"}),(0,s.jsxs)("table",{className:n().resultsTable,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Library"}),(0,s.jsx)("th",{children:"Files Processed"}),(0,s.jsx)("th",{children:"Time Taken (ms)"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.library}),(0,s.jsx)("td",{children:e.filesProcessed}),(0,s.jsx)("td",{children:e.timeTaken.toFixed(2)})]},e.library))})]})]})]})}},2638:function(e){e.exports={container:"TestPage_container__UH0HI",form:"TestPage_form__XLLAj",results:"TestPage_results__2V4Bx",resultsTable:"TestPage_resultsTable__KMCwU"}}},function(e){e.O(0,[781,485,647,70,971,190,744],function(){return e(e.s=7401)}),_N_E=e.O()}]);