(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[928],{7401:function(e,t,s){Promise.resolve().then(s.bind(s,914))},914:function(e,t,s){"use strict";s.r(t);var a=s(7437),r=s(2265),i=s(2638),n=s.n(i),l=s(6647),c=s.n(l),o=s(3070);let d=[".mp3",".flac",".m4a"];t.default=()=>{let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(!1),[l,h]=(0,r.useState)(null),[m,u]=(0,r.useState)(""),[g,j]=(0,r.useState)([]),[x,w]=(0,r.useState)([]),[b,f]=(0,r.useState)(!1),[p,y]=(0,r.useState)("jsmediatags");(0,r.useEffect)(()=>{if(window.taglibWasm){f(!0);return}let e=document.createElement("script");return e.src="/audio/vendor/taglib-wasm/lib-via-script-tag.js",e.async=!0,e.onload=()=>f(!0),e.onerror=()=>console.error("Failed to load the taglib-wasm script."),document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]);let T=async()=>{try{let e=await window.showDirectoryPicker();h(e),t([]),u("Selected directory: ".concat(e.name))}catch(e){e instanceof DOMException&&"AbortError"===e.name?console.log("Directory selection was canceled."):console.error("Error selecting directory:",e)}},_=async e=>{let t=[],s=async e=>{for await(let a of e.values())"file"===a.kind?d.some(e=>a.name.toLowerCase().endsWith(e))&&t.push(a):"directory"===a.kind&&await s(a)};return await s(e),t},k=async(e,s)=>{t([]),j([]),w([]),u("Testing ".concat(s,"..."));let a=performance.now(),r=0,i=[],n=[];try{if("jsmediatags"===s)for(let t of e){let e=await t.getFile();await new Promise((t,s)=>{c().read(e,{onSuccess:e=>{n.push(e.tags),t()},onError:e=>s(e)})}),r++}else if("music-metadata-browser"===s)for(let t of e){let e=await t.getFile(),s=await o.Aj(e);n.push(s.common),r++}else if("taglib-wasm"===s){if(b&&window.taglibWasm){let t=await window.taglibWasm.TagLib.initialize({locateFile:e=>e.endsWith(".wasm")?"/audio/vendor/taglib-wasm/taglib.wasm":e});for(let s of e)try{let e=await s.getFile(),a=await e.arrayBuffer(),i=new Uint8Array(a),l=await t.open(i,e.name),c=l.tag();n.push({title:c.title,artist:c.artist,album:c.album,year:c.year,track:c.track,genre:c.genre}),l.dispose(),r++}catch(t){let e="taglib-wasm failed to process ".concat(s.name,": ").concat(t instanceof Error?t.message:String(t));console.error(e),i.push(e)}}else throw Error("taglib-wasm is not loaded.")}}catch(e){u("Error during testing ".concat(s,": ").concat(e instanceof Error?e.message:String(e))),console.error(e),t([{library:s,filesProcessed:r,timeTaken:performance.now()-a}]),j(i);return}t([{library:s,filesProcessed:r,timeTaken:performance.now()-a}]),j(i),w(n)},v=async()=>{if(!l)return;i(!0),u("Scanning directory for audio files...");let e=await _(l);u("Found ".concat(e.length," audio files. Now running test...")),await k(e,p),i(!1),u("Testing complete. Processed ".concat(e.length," files with ").concat(p,"."))};return(0,a.jsxs)("div",{className:n().container,children:[(0,a.jsx)("h1",{children:"Metadata Speed Test"}),(0,a.jsxs)("div",{className:n().form,children:[(0,a.jsx)("button",{onClick:T,disabled:s,children:l?"Selected: ".concat(l.name):"Select Directory"}),(0,a.jsxs)("select",{value:p,onChange:e=>y(e.target.value),children:[(0,a.jsx)("option",{value:"jsmediatags",children:"jsmediatags"}),(0,a.jsx)("option",{value:"music-metadata-browser",children:"music-metadata-browser"}),(0,a.jsx)("option",{value:"taglib-wasm",children:"taglib-wasm"})]}),(0,a.jsx)("button",{onClick:v,disabled:!l||s||"taglib-wasm"===p&&!b,children:s?"Scanning...":"Run Test"})]}),!b&&(0,a.jsx)("p",{children:"Loading metadata library..."}),m&&(0,a.jsx)("p",{children:m}),g.length>0&&(0,a.jsxs)("div",{className:n().errors,children:[(0,a.jsx)("h2",{children:"Errors"}),(0,a.jsx)("ul",{children:g.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]}),e.length>0&&(0,a.jsxs)("div",{className:n().results,children:[(0,a.jsx)("h2",{children:"Results"}),(0,a.jsxs)("table",{className:n().resultsTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Library"}),(0,a.jsx)("th",{children:"Files Processed"}),(0,a.jsx)("th",{children:"Time Taken (ms)"})]})}),(0,a.jsx)("tbody",{children:e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.library}),(0,a.jsx)("td",{children:e.filesProcessed}),(0,a.jsx)("td",{children:e.timeTaken.toFixed(2)})]},e.library))})]})]}),x.length>0&&(0,a.jsxs)("div",{className:n().results,children:[(0,a.jsx)("h2",{children:"Extracted Tags"}),(0,a.jsxs)("table",{className:n().resultsTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Title"}),(0,a.jsx)("th",{children:"Artist"}),(0,a.jsx)("th",{children:"Album"}),(0,a.jsx)("th",{children:"Year"}),(0,a.jsx)("th",{children:"Track"}),(0,a.jsx)("th",{children:"Genre"})]})}),(0,a.jsx)("tbody",{children:x.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.title}),(0,a.jsx)("td",{children:e.artist}),(0,a.jsx)("td",{children:e.album}),(0,a.jsx)("td",{children:e.year}),(0,a.jsx)("td",{children:e.track}),(0,a.jsx)("td",{children:e.genre})]},t))})]})]})]})}},2638:function(e){e.exports={container:"TestPage_container__UH0HI",form:"TestPage_form__XLLAj",results:"TestPage_results__2V4Bx",resultsTable:"TestPage_resultsTable__KMCwU",errors:"TestPage_errors__IR6FX"}}},function(e){e.O(0,[781,485,647,70,971,190,744],function(){return e(e.s=7401)}),_N_E=e.O()}]);